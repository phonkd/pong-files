services:
  mystrom-exporter:
    image: ghcr.io/peschmae/exporter-go-mystrom:2.1.0
    container_name: mystrom-exporter
    restart: unless-stopped
    ports:
      - "9452:9452"
    # networks:
    #   - prometheus-net

  prometheus:
    network_mode: host
    image: prom/prometheus:latest
    container_name: prometheus
    restart: unless-stopped
    user: root
    cap_add:
      - NET_BIND_SERVICE
      - NET_RAW
    ports:
      - "10123:10123"
    volumes:
      - prometheus-data:/prometheus
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/etc/prometheus/console_libraries'
      - '--web.console.templates=/etc/prometheus/consoles'
      - '--web.listen-address=:10123'
    depends_on:
      - mystrom-exporter
    # networks:
    #   - prometheus-net

volumes:
  prometheus-data:

# networks:
#   prometheus-net:
#     driver: bridge
